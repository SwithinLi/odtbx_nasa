<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><link rel="stylesheet" href="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\matlab-report-styles.css" type="text/css" /><title>Function details for interp1</title><link rel="stylesheet" href="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">interp1 (4 calls, 0.058 sec)</span><br/><i>Generated 29-May-2009 12:06:28 using cpu time.</i><br/>M-function in file C:\Program Files\MATLAB\R2008a\toolbox\matlab\polyfun\interp1.m<br/>[Copy to new window for comparing multiple runs]<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td></tr><tr><td class="td-linebottomrt"><a href="file20.html">gpsmeas</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">4</td></tr></table><div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line279">279</a></td><td class="td-linebottomrt"><pre>yiMat = spline(xCol.',yMat.',x...</pre></td><td class="td-linebottomrt">4</td><td class="td-linebottomrt">0.043 s</td><td class="td-linebottomrt" class="td-linebottomrt">73.9%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=74 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line77">77</a></td><td class="td-linebottomrt"><pre>if (nargin==2) || ...</pre></td><td class="td-linebottomrt">4</td><td class="td-linebottomrt">0.009 s</td><td class="td-linebottomrt" class="td-linebottomrt">14.8%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=15 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line244">244</a></td><td class="td-linebottomrt"><pre>if eqsp</pre></td><td class="td-linebottomrt">4</td><td class="td-linebottomrt">0.001 s</td><td class="td-linebottomrt" class="td-linebottomrt">2.5%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=3 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line160">160</a></td><td class="td-linebottomrt"><pre>if xOffset &amp;&amp; ~isreal(...</pre></td><td class="td-linebottomrt">4</td><td class="td-linebottomrt">0.001 s</td><td class="td-linebottomrt" class="td-linebottomrt">2.3%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=2 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line211">211</a></td><td class="td-linebottomrt"><pre>end</pre></td><td class="td-linebottomrt">4</td><td class="td-linebottomrt">0.001 s</td><td class="td-linebottomrt" class="td-linebottomrt">1.3%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.003 s</td><td class="td-linebottomrt">5.2%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=5 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">0.058 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file55.html">spline</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">4</td><td class="td-linebottomrt">0.042 s</td><td class="td-linebottomrt">72.5%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=72 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.016 s</td><td class="td-linebottomrt">27.5%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=28 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">0.058 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>M-Lint results</strong><br/>No M-Lint messages.<div class="grayline"/><strong>Coverage results</strong><br/>[ Show coverage for parent directory ]<br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td><td class="td-linebottomrt">424</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">214</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">210</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">65</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">145</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">30.95 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><pre> <span style="color: #FF0000; font-weight: bold; text-decoration: none">  time</span> <span style="color: #0000FF; font-weight: bold; text-decoration: none">  calls</span>  <span style="font-weight: bold; text-decoration: none">line</span><br/>               <span style="color: #A0A0A0">   1</span> <span style="color: #A0A0A0; background: #FFFFFF;">function varargout = interp1(varargin)</span><br/>               <span style="color: #A0A0A0">   2</span> <span style="color: #228B22; background: #FFFFFF;">%INTERP1 1-D interpolation (table lookup)</span><br/>               <span style="color: #A0A0A0">   3</span> <span style="color: #228B22; background: #FFFFFF;">%   YI = INTERP1(X,Y,XI) interpolates to find YI, the values of the</span><br/>               <span style="color: #A0A0A0">   4</span> <span style="color: #228B22; background: #FFFFFF;">%   underlying function Y at the points in the array XI. X must be a</span><br/>               <span style="color: #A0A0A0">   5</span> <span style="color: #228B22; background: #FFFFFF;">%   vector of length N.</span><br/>               <span style="color: #A0A0A0">   6</span> <span style="color: #228B22; background: #FFFFFF;">%   If Y is a vector, then it must also have length N, and YI is the</span><br/>               <span style="color: #A0A0A0">   7</span> <span style="color: #228B22; background: #FFFFFF;">%   same size as XI.  If Y is an array of size [N,D1,D2,...,Dk], then</span><br/>               <span style="color: #A0A0A0">   8</span> <span style="color: #228B22; background: #FFFFFF;">%   the interpolation is performed for each D1-by-D2-by-...-Dk value</span><br/>               <span style="color: #A0A0A0">   9</span> <span style="color: #228B22; background: #FFFFFF;">%   in Y(i,:,:,...,:).</span><br/>               <span style="color: #A0A0A0">  10</span> <span style="color: #228B22; background: #FFFFFF;">%   If XI is a vector of length M, then YI has size [M,D1,D2,...,Dk].</span><br/>               <span style="color: #A0A0A0">  11</span> <span style="color: #228B22; background: #FFFFFF;">%   If XI is an array of size [M1,M2,...,Mj], then YI is of size</span><br/>               <span style="color: #A0A0A0">  12</span> <span style="color: #228B22; background: #FFFFFF;">%   [M1,M2,...,Mj,D1,D2,...,Dk].</span><br/>               <span style="color: #A0A0A0">  13</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  14</span> <span style="color: #228B22; background: #FFFFFF;">%   YI = INTERP1(Y,XI) assumes X = 1:N, where N is LENGTH(Y)</span><br/>               <span style="color: #A0A0A0">  15</span> <span style="color: #228B22; background: #FFFFFF;">%   for vector Y or SIZE(Y,1) for array Y.</span><br/>               <span style="color: #A0A0A0">  16</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  17</span> <span style="color: #228B22; background: #FFFFFF;">%   Interpolation is the same operation as "table lookup".  Described in</span><br/>               <span style="color: #A0A0A0">  18</span> <span style="color: #228B22; background: #FFFFFF;">%   "table lookup" terms, the "table" is [X,Y] and INTERP1 "looks-up"</span><br/>               <span style="color: #A0A0A0">  19</span> <span style="color: #228B22; background: #FFFFFF;">%   the elements of XI in X, and, based upon their location, returns</span><br/>               <span style="color: #A0A0A0">  20</span> <span style="color: #228B22; background: #FFFFFF;">%   values YI interpolated within the elements of Y.</span><br/>               <span style="color: #A0A0A0">  21</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  22</span> <span style="color: #228B22; background: #FFFFFF;">%   YI = INTERP1(X,Y,XI,METHOD) specifies alternate methods.</span><br/>               <span style="color: #A0A0A0">  23</span> <span style="color: #228B22; background: #FFFFFF;">%   The default is linear interpolation. Use an empty matrix [] to specify</span><br/>               <span style="color: #A0A0A0">  24</span> <span style="color: #228B22; background: #FFFFFF;">%   the default. Available methods are:</span><br/>               <span style="color: #A0A0A0">  25</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  26</span> <span style="color: #228B22; background: #FFFFFF;">%     'nearest'  - nearest neighbor interpolation</span><br/>               <span style="color: #A0A0A0">  27</span> <span style="color: #228B22; background: #FFFFFF;">%     'linear'   - linear interpolation</span><br/>               <span style="color: #A0A0A0">  28</span> <span style="color: #228B22; background: #FFFFFF;">%     'spline'   - piecewise cubic spline interpolation (SPLINE)</span><br/>               <span style="color: #A0A0A0">  29</span> <span style="color: #228B22; background: #FFFFFF;">%     'pchip'    - shape-preserving piecewise cubic interpolation</span><br/>               <span style="color: #A0A0A0">  30</span> <span style="color: #228B22; background: #FFFFFF;">%     'cubic'    - same as 'pchip'</span><br/>               <span style="color: #A0A0A0">  31</span> <span style="color: #228B22; background: #FFFFFF;">%     'v5cubic'  - the cubic interpolation from MATLAB 5, which does not</span><br/>               <span style="color: #A0A0A0">  32</span> <span style="color: #228B22; background: #FFFFFF;">%                  extrapolate and uses 'spline' if X is not equally</span><br/>               <span style="color: #A0A0A0">  33</span> <span style="color: #228B22; background: #FFFFFF;">%                  spaced.</span><br/>               <span style="color: #A0A0A0">  34</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  35</span> <span style="color: #228B22; background: #FFFFFF;">%   YI = INTERP1(X,Y,XI,METHOD,'extrap') uses the specified method for</span><br/>               <span style="color: #A0A0A0">  36</span> <span style="color: #228B22; background: #FFFFFF;">%   extrapolation for any elements of XI outside the interval spanned by X.</span><br/>               <span style="color: #A0A0A0">  37</span> <span style="color: #228B22; background: #FFFFFF;">%   Alternatively, YI = INTERP1(X,Y,XI,METHOD,EXTRAPVAL) replaces</span><br/>               <span style="color: #A0A0A0">  38</span> <span style="color: #228B22; background: #FFFFFF;">%   the values outside of the interval spanned by X with EXTRAPVAL.</span><br/>               <span style="color: #A0A0A0">  39</span> <span style="color: #228B22; background: #FFFFFF;">%   NaN and 0 are often used for EXTRAPVAL.  The default extrapolation</span><br/>               <span style="color: #A0A0A0">  40</span> <span style="color: #228B22; background: #FFFFFF;">%   behavior with four input arguments is 'extrap' for 'spline' and 'pchip'</span><br/>               <span style="color: #A0A0A0">  41</span> <span style="color: #228B22; background: #FFFFFF;">%   and EXTRAPVAL = NaN for the other methods.</span><br/>               <span style="color: #A0A0A0">  42</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  43</span> <span style="color: #228B22; background: #FFFFFF;">%   PP = INTERP1(X,Y,METHOD,'pp') will use the specified method to</span><br/>               <span style="color: #A0A0A0">  44</span> <span style="color: #228B22; background: #FFFFFF;">%   generate the ppform (piecewise polynomial form) of Y. The method may be</span><br/>               <span style="color: #A0A0A0">  45</span> <span style="color: #228B22; background: #FFFFFF;">%   any of the above except for 'v5cubic'. PP may then be evaluated via</span><br/>               <span style="color: #A0A0A0">  46</span> <span style="color: #228B22; background: #FFFFFF;">%   PPVAL. PPVAL(PP,XI) is the same as INTERP1(X,Y,XI,METHOD,'extrap').</span><br/>               <span style="color: #A0A0A0">  47</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  48</span> <span style="color: #228B22; background: #FFFFFF;">%   For example, generate a coarse sine curve and interpolate over a</span><br/>               <span style="color: #A0A0A0">  49</span> <span style="color: #228B22; background: #FFFFFF;">%   finer abscissa:</span><br/>               <span style="color: #A0A0A0">  50</span> <span style="color: #228B22; background: #FFFFFF;">%       x = 0:10; y = sin(x); xi = 0:.25:10;</span><br/>               <span style="color: #A0A0A0">  51</span> <span style="color: #228B22; background: #FFFFFF;">%       yi = interp1(x,y,xi); plot(x,y,'o',xi,yi)</span><br/>               <span style="color: #A0A0A0">  52</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  53</span> <span style="color: #228B22; background: #FFFFFF;">%   For a multi-dimensional example, we construct a table of functional</span><br/>               <span style="color: #A0A0A0">  54</span> <span style="color: #228B22; background: #FFFFFF;">%   values:</span><br/>               <span style="color: #A0A0A0">  55</span> <span style="color: #228B22; background: #FFFFFF;">%       x = [1:10]'; y = [ x.^2, x.^3, x.^4 ];</span><br/>               <span style="color: #A0A0A0">  56</span> <span style="color: #228B22; background: #FFFFFF;">%       xi = [ 1.5, 1.75; 7.5, 7.75]; yi = interp1(x,y,xi);</span><br/>               <span style="color: #A0A0A0">  57</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  58</span> <span style="color: #228B22; background: #FFFFFF;">%   creates 2-by-2 matrices of interpolated function values, one matrix for</span><br/>               <span style="color: #A0A0A0">  59</span> <span style="color: #228B22; background: #FFFFFF;">%   each of the 3 functions. yi will be of size 2-by-2-by-3.</span><br/>               <span style="color: #A0A0A0">  60</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  61</span> <span style="color: #228B22; background: #FFFFFF;">%   Class support for inputs X, Y, XI, EXTRAPVAL:</span><br/>               <span style="color: #A0A0A0">  62</span> <span style="color: #228B22; background: #FFFFFF;">%      float: double, single</span><br/>               <span style="color: #A0A0A0">  63</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  64</span> <span style="color: #228B22; background: #FFFFFF;">%   See also INTERP1Q, INTERPFT, SPLINE, PCHIP, INTERP2, INTERP3, INTERPN, PPVAL.</span><br/>               <span style="color: #A0A0A0">  65</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  66</span> <span style="color: #228B22; background: #FFFFFF;">%   Copyright 1984-2005 The MathWorks, Inc.</span><br/>               <span style="color: #A0A0A0">  67</span> <span style="color: #228B22; background: #FFFFFF;">%   $Revision: 5.41.4.11 $  $Date: 2005/12/12 23:26:22 $</span><br/>               <span style="color: #A0A0A0">  68</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  69</span> <span style="color: #228B22; background: #FFFFFF;">% Determine input arguments.</span><br/>               <span style="color: #A0A0A0">  70</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  71</span> <span style="color: #228B22; background: #FFFFFF;">% The following syntaxes do not have X as the first input:</span><br/>               <span style="color: #A0A0A0">  72</span> <span style="color: #228B22; background: #FFFFFF;">% INTERP1(Y,XI)</span><br/>               <span style="color: #A0A0A0">  73</span> <span style="color: #228B22; background: #FFFFFF;">% INTERP1(Y,XI,METHOD)</span><br/>               <span style="color: #A0A0A0">  74</span> <span style="color: #228B22; background: #FFFFFF;">% INTERP1(Y,XI,METHOD,'extrap')</span><br/>               <span style="color: #A0A0A0">  75</span> <span style="color: #228B22; background: #FFFFFF;">% INTERP1(Y,XI,METHOD,EXTRAPVAL)</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold">  76</span> <span style="color: #000000; background: #FFFFFF;">xOffset = 1; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold">  77</span> <a name="Line77"></a><span style="color: #000000; background: #FFE2E2;">if (nargin==2) || ... </span><br/>               <span style="color: #A0A0A0">  78</span> <span style="color: #000000; background: #FFE2E2;">   (nargin==3 &amp;&amp; ischar(varargin{3}))  || ...</span><br/>               <span style="color: #A0A0A0">  79</span> <span style="color: #000000; background: #FFE2E2;">   (nargin==4 &amp;&amp; ~(ischar(varargin{4}) || isempty(varargin{4})) || ...</span><br/>               <span style="color: #A0A0A0">  80</span> <span style="color: #000000; background: #FFE2E2;">   (nargin==4 &amp;&amp; strcmp(varargin{4}, 'extrap')));</span><br/>               <span style="color: #A0A0A0">  81</span> <span style="color: #A0A0A0; background: #FFFFFF;">    xOffset = 0;</span><br/>               <span style="color: #A0A0A0">  82</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0">  83</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold">  84</span> <span style="color: #000000; background: #FFFFFF;">ppOutput = false; </span><br/>               <span style="color: #A0A0A0">  85</span> <span style="color: #228B22; background: #FFFFFF;">% PP = INTERP1(X,Y,METHOD,'pp')</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold">  86</span> <span style="color: #000000; background: #FFFFFF;">if nargin&gt;=4 &amp;&amp; ischar(varargin{3}) &amp;&amp; isequal('pp',varargin{4}) </span><br/>               <span style="color: #A0A0A0">  87</span> <span style="color: #A0A0A0; background: #FFFFFF;">    ppOutput = true;</span><br/>               <span style="color: #A0A0A0">  88</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if (nargin &gt; 4)</span><br/>               <span style="color: #A0A0A0">  89</span> <span style="color: #A0A0A0; background: #FFFFFF;">        error('MATLAB:interp1:ppOutput', ...</span><br/>               <span style="color: #A0A0A0">  90</span> <span style="color: #A0A0A0; background: #FFFFFF;">            'Use 4 inputs for PP=INTERP1(X,Y,METHOD,''pp'').')</span><br/>               <span style="color: #A0A0A0">  91</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0">  92</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0">  93</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  94</span> <span style="color: #228B22; background: #FFFFFF;">% Process Y in INTERP1(Y,...) and INTERP1(X,Y,...)</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold">  95</span> <span style="color: #000000; background: #FFFFFF;">y = varargin{1+xOffset}; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold">  96</span> <span style="color: #000000; background: #FFFFFF;">siz_y = size(y); </span><br/>               <span style="color: #A0A0A0">  97</span> <span style="color: #228B22; background: #FFFFFF;">% y may be an ND array, but collapse it down to a 2D yMat. If yMat is</span><br/>               <span style="color: #A0A0A0">  98</span> <span style="color: #228B22; background: #FFFFFF;">% a vector, it is a column vector.</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold">  99</span> <span style="color: #000000; background: #FFFFFF;">if isvector(y) </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 100</span> <span style="color: #000000; background: #FFFFFF;">    if size(y,1) == 1 </span><br/>               <span style="color: #A0A0A0"> 101</span> <span style="color: #228B22; background: #FFFFFF;">        % Prefer column vectors for y</span><br/>               <span style="color: #A0A0A0"> 102</span> <span style="color: #A0A0A0; background: #FFFFFF;">        yMat = y.';</span><br/>               <span style="color: #A0A0A0"> 103</span> <span style="color: #A0A0A0; background: #FFFFFF;">        n = siz_y(2);</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 104</span> <span style="color: #228B22; background: #FFFFFF;">    else </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 105</span> <span style="color: #000000; background: #FFFFFF;">        yMat = y; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 106</span> <span style="color: #000000; background: #FFFFFF;">        n = siz_y(1); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 107</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 108</span> <span style="color: #000000; background: #FFFFFF;">    ds = 1; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 109</span> <span style="color: #000000; background: #FFFFFF;">    prodDs = 1; </span><br/>               <span style="color: #A0A0A0"> 110</span> <span style="color: #228B22; background: #FFFFFF;">else</span><br/>               <span style="color: #A0A0A0"> 111</span> <span style="color: #A0A0A0; background: #FFFFFF;">    n = siz_y(1);</span><br/>               <span style="color: #A0A0A0"> 112</span> <span style="color: #A0A0A0; background: #FFFFFF;">    ds = siz_y(2:end);</span><br/>               <span style="color: #A0A0A0"> 113</span> <span style="color: #A0A0A0; background: #FFFFFF;">    prodDs = prod(ds);</span><br/>               <span style="color: #A0A0A0"> 114</span> <span style="color: #A0A0A0; background: #FFFFFF;">    yMat = reshape(y,[n prodDs]);</span><br/>               <span style="color: #A0A0A0"> 115</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 116</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 117</span> <span style="color: #228B22; background: #FFFFFF;">% Process X in INTERP1(X,Y,...), or supply default for INTERP1(Y,...)</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 118</span> <span style="color: #000000; background: #FFFFFF;">if xOffset </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 119</span> <span style="color: #000000; background: #FFFFFF;">    x = varargin{xOffset}; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 120</span> <span style="color: #000000; background: #FFFFFF;">    if ~isvector(x) </span><br/>               <span style="color: #A0A0A0"> 121</span> <span style="color: #A0A0A0; background: #FFFFFF;">        error('MATLAB:interp1:Xvector','X must be a vector.');</span><br/>               <span style="color: #A0A0A0"> 122</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 123</span> <span style="color: #000000; background: #FFFFFF;">    if length(x) ~= n </span><br/>               <span style="color: #A0A0A0"> 124</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if isvector(y)</span><br/>               <span style="color: #A0A0A0"> 125</span> <span style="color: #A0A0A0; background: #FFFFFF;">            error('MATLAB:interp1:YInvalidNumRows', ...</span><br/>               <span style="color: #A0A0A0"> 126</span> <span style="color: #A0A0A0; background: #FFFFFF;">                'X and Y must be of the same length.')</span><br/>               <span style="color: #A0A0A0"> 127</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 128</span> <span style="color: #A0A0A0; background: #FFFFFF;">            error('MATLAB:interp1:YInvalidNumRows', ...</span><br/>               <span style="color: #A0A0A0"> 129</span> <span style="color: #A0A0A0; background: #FFFFFF;">                'LENGTH(X) and SIZE(Y,1) must be the same.');</span><br/>               <span style="color: #A0A0A0"> 130</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 131</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 132</span> <span style="color: #228B22; background: #FFFFFF;">    % Prefer column vectors for x</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 133</span> <span style="color: #000000; background: #FFFFFF;">    xCol = x(:); </span><br/>               <span style="color: #A0A0A0"> 134</span> <span style="color: #228B22; background: #FFFFFF;">else</span><br/>               <span style="color: #A0A0A0"> 135</span> <span style="color: #A0A0A0; background: #FFFFFF;">    xCol = (1:n)';</span><br/>               <span style="color: #A0A0A0"> 136</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 137</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 138</span> <span style="color: #228B22; background: #FFFFFF;">% Process XI in INTERP1(Y,XI,...) and INTERP1(X,Y,XI,...)</span><br/>               <span style="color: #A0A0A0"> 139</span> <span style="color: #228B22; background: #FFFFFF;">% Avoid syntax PP = INTERP1(X,Y,METHOD,'pp')</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 140</span> <span style="color: #000000; background: #FFFFFF;">if ~ppOutput </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 141</span> <span style="color: #000000; background: #FFFFFF;">    xi = varargin{2+xOffset}; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 142</span> <span style="color: #000000; background: #FFFFFF;">    siz_xi = size(xi); </span><br/>               <span style="color: #A0A0A0"> 143</span> <span style="color: #228B22; background: #FFFFFF;">    % xi may be an ND array, but flatten it to a column vector xiCol</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 144</span> <span style="color: #000000; background: #FFFFFF;">    xiCol = xi(:); </span><br/>               <span style="color: #A0A0A0"> 145</span> <span style="color: #228B22; background: #FFFFFF;">    % The size of the output YI</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 146</span> <span style="color: #000000; background: #FFFFFF;">    if isvector(y) </span><br/>               <span style="color: #A0A0A0"> 147</span> <span style="color: #228B22; background: #FFFFFF;">        % Y is a vector so size(YI) == size(XI)</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 148</span> <span style="color: #000000; background: #FFFFFF;">        siz_yi = siz_xi; </span><br/>               <span style="color: #A0A0A0"> 149</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/>               <span style="color: #A0A0A0"> 150</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if isvector(xi)</span><br/>               <span style="color: #A0A0A0"> 151</span> <span style="color: #228B22; background: #FFFFFF;">            % Y is not a vector but XI is</span><br/>               <span style="color: #A0A0A0"> 152</span> <span style="color: #A0A0A0; background: #FFFFFF;">            siz_yi = [length(xi) ds];</span><br/>               <span style="color: #A0A0A0"> 153</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 154</span> <span style="color: #228B22; background: #FFFFFF;">            % Both Y and XI are non-vectors</span><br/>               <span style="color: #A0A0A0"> 155</span> <span style="color: #A0A0A0; background: #FFFFFF;">            siz_yi = [siz_xi ds];</span><br/>               <span style="color: #A0A0A0"> 156</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 157</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 158</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 159</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 160</span> <a name="Line160"></a><span style="color: #000000; background: #FFFFFF;">if xOffset &amp;&amp; ~isreal(x) </span><br/>               <span style="color: #A0A0A0"> 161</span> <span style="color: #A0A0A0; background: #FFFFFF;">    error('MATLAB:interp1:ComplexX','X should be a real vector.')</span><br/>               <span style="color: #A0A0A0"> 162</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 163</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 164</span> <span style="color: #000000; background: #FFFFFF;">if ~ppOutput &amp;&amp; ~isreal(xi) </span><br/>               <span style="color: #A0A0A0"> 165</span> <span style="color: #A0A0A0; background: #FFFFFF;">    error('MATLAB:interp1:ComplexInterpPts', ...</span><br/>               <span style="color: #A0A0A0"> 166</span> <span style="color: #A0A0A0; background: #FFFFFF;">        'The interpolation points XI should be real.')</span><br/>               <span style="color: #A0A0A0"> 167</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 168</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 169</span> <span style="color: #228B22; background: #FFFFFF;">% Error check for NaN values in X and Y</span><br/>               <span style="color: #A0A0A0"> 170</span> <span style="color: #228B22; background: #FFFFFF;">% check for NaN's</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 171</span> <span style="color: #000000; background: #FFFFFF;">if xOffset &amp;&amp; (any(isnan(xCol))) </span><br/>               <span style="color: #A0A0A0"> 172</span> <span style="color: #A0A0A0; background: #FFFFFF;">    error('MATLAB:interp1:NaNinX','NaN is not an appropriate value for X.');</span><br/>               <span style="color: #A0A0A0"> 173</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 174</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 175</span> <span style="color: #228B22; background: #FFFFFF;">% NANS are allowed as a value for F(X), since a function may be undefined</span><br/>               <span style="color: #A0A0A0"> 176</span> <span style="color: #228B22; background: #FFFFFF;">% for a given value.</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 177</span> <span style="color: #000000; background: #FFFFFF;">if any(isnan(yMat(:))) </span><br/>               <span style="color: #A0A0A0"> 178</span> <span style="color: #A0A0A0; background: #FFFFFF;">    warning('MATLAB:interp1:NaNinY', ...</span><br/>               <span style="color: #A0A0A0"> 179</span> <span style="color: #A0A0A0; background: #FFFFFF;">        ['NaN found in Y, interpolation at undefined values \n\t',...</span><br/>               <span style="color: #A0A0A0"> 180</span> <span style="color: #A0A0A0; background: #FFFFFF;">        ' will result in undefined values.']);</span><br/>               <span style="color: #A0A0A0"> 181</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 182</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 183</span> <span style="color: #000000; background: #FFFFFF;">if (n &lt; 2) </span><br/>               <span style="color: #A0A0A0"> 184</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if ppOutput || ~isempty(xi)</span><br/>               <span style="color: #A0A0A0"> 185</span> <span style="color: #A0A0A0; background: #FFFFFF;">        error('MATLAB:interp1:NotEnoughPts', ...</span><br/>               <span style="color: #A0A0A0"> 186</span> <span style="color: #A0A0A0; background: #FFFFFF;">            'There should be at least two data points.')</span><br/>               <span style="color: #A0A0A0"> 187</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/>               <span style="color: #A0A0A0"> 188</span> <span style="color: #A0A0A0; background: #FFFFFF;">        yi = zeros(siz_yi,superiorfloat(x,y,xi));</span><br/>               <span style="color: #A0A0A0"> 189</span> <span style="color: #A0A0A0; background: #FFFFFF;">        varargout{1} = yi;</span><br/>               <span style="color: #A0A0A0"> 190</span> <span style="color: #A0A0A0; background: #FFFFFF;">        return</span><br/>               <span style="color: #A0A0A0"> 191</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 192</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 193</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 194</span> <span style="color: #228B22; background: #FFFFFF;">% Process METHOD in</span><br/>               <span style="color: #A0A0A0"> 195</span> <span style="color: #228B22; background: #FFFFFF;">% PP = INTERP1(X,Y,METHOD,'pp')</span><br/>               <span style="color: #A0A0A0"> 196</span> <span style="color: #228B22; background: #FFFFFF;">% YI = INTERP1(Y,XI,METHOD,...)</span><br/>               <span style="color: #A0A0A0"> 197</span> <span style="color: #228B22; background: #FFFFFF;">% YI = INTERP1(X,Y,XI,METHOD,...)</span><br/>               <span style="color: #A0A0A0"> 198</span> <span style="color: #228B22; background: #FFFFFF;">% including explicit specification of the default by an empty input.</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 199</span> <span style="color: #000000; background: #FFFFFF;">if ppOutput </span><br/>               <span style="color: #A0A0A0"> 200</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if isempty(varargin{3})</span><br/>               <span style="color: #A0A0A0"> 201</span> <span style="color: #A0A0A0; background: #FFFFFF;">        method = 'linear';</span><br/>               <span style="color: #A0A0A0"> 202</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/>               <span style="color: #A0A0A0"> 203</span> <span style="color: #A0A0A0; background: #FFFFFF;">        method = varargin{3};</span><br/>               <span style="color: #A0A0A0"> 204</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 205</span> <span style="color: #228B22; background: #FFFFFF;">else </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 206</span> <span style="color: #000000; background: #FFFFFF;">    if nargin &gt;= 3+xOffset &amp;&amp; ~isempty(varargin{3+xOffset}) </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 207</span> <span style="color: #000000; background: #FFFFFF;">        method = varargin{3+xOffset}; </span><br/>               <span style="color: #A0A0A0"> 208</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/>               <span style="color: #A0A0A0"> 209</span> <span style="color: #A0A0A0; background: #FFFFFF;">        method = 'linear';</span><br/>               <span style="color: #A0A0A0"> 210</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 211</span> <a name="Line211"></a><span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 212</span> <span style="color: #228B22; background: #FFFFFF;">    </span><br/>               <span style="color: #A0A0A0"> 213</span> <span style="color: #228B22; background: #FFFFFF;">% The v5 option, '*method', asserts that x is equally spaced.</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 214</span> <span style="color: #000000; background: #FFFFFF;">eqsp = (method(1) == '*'); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 215</span> <span style="color: #000000; background: #FFFFFF;">if eqsp </span><br/>               <span style="color: #A0A0A0"> 216</span> <span style="color: #A0A0A0; background: #FFFFFF;">    method(1) = [];</span><br/>               <span style="color: #A0A0A0"> 217</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 218</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 219</span> <span style="color: #228B22; background: #FFFFFF;">% INTERP1([X,]Y,XI,METHOD,'extrap') and INTERP1([X,]Y,Xi,METHOD,EXTRAPVAL)</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 220</span> <span style="color: #000000; background: #FFFFFF;">if ~ppOutput </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 221</span> <span style="color: #000000; background: #FFFFFF;">    if nargin &gt;= 4+xOffset </span><br/>               <span style="color: #A0A0A0"> 222</span> <span style="color: #A0A0A0; background: #FFFFFF;">        extrapval = varargin{4+xOffset};</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 223</span> <span style="color: #228B22; background: #FFFFFF;">    else </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 224</span> <span style="color: #000000; background: #FFFFFF;">        switch method(1) </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 225</span> <span style="color: #000000; background: #FFFFFF;">            case {'s','p','c'} </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 226</span> <span style="color: #000000; background: #FFFFFF;">                extrapval = 'extrap'; </span><br/>               <span style="color: #A0A0A0"> 227</span> <span style="color: #A0A0A0; background: #FFFFFF;">            otherwise</span><br/>               <span style="color: #A0A0A0"> 228</span> <span style="color: #A0A0A0; background: #FFFFFF;">                extrapval = NaN;</span><br/>               <span style="color: #A0A0A0"> 229</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 230</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 231</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0"> 232</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 233</span> <span style="color: #228B22; background: #FFFFFF;">% Start the algorithm</span><br/>               <span style="color: #A0A0A0"> 234</span> <span style="color: #228B22; background: #FFFFFF;">% We now have column vector xCol, column vector or 2D matrix yMat and</span><br/>               <span style="color: #A0A0A0"> 235</span> <span style="color: #228B22; background: #FFFFFF;">% column vector xiCol.</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 236</span> <span style="color: #000000; background: #FFFFFF;">if xOffset </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 237</span> <span style="color: #000000; background: #FFFFFF;">    if ~eqsp </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 238</span> <span style="color: #000000; background: #FFFFFF;">        h = diff(xCol); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 239</span> <span style="color: #000000; background: #FFFFFF;">        eqsp = (norm(diff(h),Inf) &lt;= eps(norm(xCol,Inf))); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 240</span> <span style="color: #000000; background: #FFFFFF;">        if any(~isfinite(xCol)) </span><br/>               <span style="color: #A0A0A0"> 241</span> <span style="color: #A0A0A0; background: #FFFFFF;">            eqsp = 0; % if an INF in x, x is not equally spaced</span><br/>               <span style="color: #A0A0A0"> 242</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 243</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 244</span> <a name="Line244"></a><span style="color: #000000; background: #FFFFFF;">    if eqsp </span><br/>               <span style="color: #A0A0A0"> 245</span> <span style="color: #A0A0A0; background: #FFFFFF;">        h = (xCol(n)-xCol(1))/(n-1);</span><br/>               <span style="color: #A0A0A0"> 246</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 247</span> <span style="color: #228B22; background: #FFFFFF;">else</span><br/>               <span style="color: #A0A0A0"> 248</span> <span style="color: #A0A0A0; background: #FFFFFF;">    h = 1;</span><br/>               <span style="color: #A0A0A0"> 249</span> <span style="color: #A0A0A0; background: #FFFFFF;">    eqsp = 1;</span><br/>               <span style="color: #A0A0A0"> 250</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 251</span> <span style="color: #000000; background: #FFFFFF;">if any(h &lt; 0) </span><br/>               <span style="color: #A0A0A0"> 252</span> <span style="color: #A0A0A0; background: #FFFFFF;">    [xCol,p] = sort(xCol);</span><br/>               <span style="color: #A0A0A0"> 253</span> <span style="color: #A0A0A0; background: #FFFFFF;">    yMat = yMat(p,:);</span><br/>               <span style="color: #A0A0A0"> 254</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if eqsp</span><br/>               <span style="color: #A0A0A0"> 255</span> <span style="color: #A0A0A0; background: #FFFFFF;">        h = -h;</span><br/>               <span style="color: #A0A0A0"> 256</span> <span style="color: #228B22; background: #FFFFFF;">    else</span><br/>               <span style="color: #A0A0A0"> 257</span> <span style="color: #A0A0A0; background: #FFFFFF;">        h = diff(xCol);</span><br/>               <span style="color: #A0A0A0"> 258</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 259</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 260</span> <span style="color: #000000; background: #FFFFFF;">if any(h == 0) </span><br/>               <span style="color: #A0A0A0"> 261</span> <span style="color: #A0A0A0; background: #FFFFFF;">    error('MATLAB:interp1:RepeatedValuesX', ...</span><br/>               <span style="color: #A0A0A0"> 262</span> <span style="color: #A0A0A0; background: #FFFFFF;">        'The values of X should be distinct.');</span><br/>               <span style="color: #A0A0A0"> 263</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 264</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 265</span> <span style="color: #228B22; background: #FFFFFF;">% PP = INTERP1(X,Y,METHOD,'pp')</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 266</span> <span style="color: #000000; background: #FFFFFF;">if nargin==4 &amp;&amp; ischar(varargin{3}) &amp;&amp; isequal('pp',varargin{4})  </span><br/>               <span style="color: #A0A0A0"> 267</span> <span style="color: #228B22; background: #FFFFFF;">    % obtain pp form of output</span><br/>               <span style="color: #A0A0A0"> 268</span> <span style="color: #A0A0A0; background: #FFFFFF;">    pp = ppinterp;</span><br/>               <span style="color: #A0A0A0"> 269</span> <span style="color: #A0A0A0; background: #FFFFFF;">    varargout{1} = pp;</span><br/>               <span style="color: #A0A0A0"> 270</span> <span style="color: #A0A0A0; background: #FFFFFF;">    return</span><br/>               <span style="color: #A0A0A0"> 271</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 272</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 273</span> <span style="color: #228B22; background: #FFFFFF;">% Interpolate</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 274</span> <span style="color: #000000; background: #FFFFFF;">numelXi = length(xiCol); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 275</span> <span style="color: #000000; background: #FFFFFF;">p = []; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 276</span> <span style="color: #000000; background: #FFFFFF;">switch method(1) </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 277</span> <span style="color: #000000; background: #FFFFFF;">    case 's'  % '<a href="file55.html">spline</a>' </span><br/>               <span style="color: #A0A0A0"> 278</span> <span style="color: #228B22; background: #FFFFFF;">        % spline is oriented opposite to interp1</span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 279</span> <a name="Line279"></a><span style="color: #000000; background: #FF8080;">        yiMat = <a href="file55.html">spline</a>(xCol.',yMat.',xiCol.').'; </span><br/>               <span style="color: #A0A0A0"> 280</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 281</span> <span style="color: #A0A0A0; background: #FFFFFF;">    case {'c','p'}  % 'cubic' or 'pchip'</span><br/>               <span style="color: #A0A0A0"> 282</span> <span style="color: #228B22; background: #FFFFFF;">        % pchip is oriented opposite to interp1</span><br/>               <span style="color: #A0A0A0"> 283</span> <span style="color: #A0A0A0; background: #FFFFFF;">        yiMat = pchip(xCol.',yMat.',xiCol.').';</span><br/>               <span style="color: #A0A0A0"> 284</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 285</span> <span style="color: #A0A0A0; background: #FFFFFF;">    otherwise % 'nearest', 'linear', 'v5cubic'</span><br/>               <span style="color: #A0A0A0"> 286</span> <span style="color: #A0A0A0; background: #FFFFFF;">        yiMat = zeros(numelXi,prodDs,superiorfloat(xCol,yMat,xiCol));</span><br/>               <span style="color: #A0A0A0"> 287</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if ~eqsp &amp;&amp; any(diff(xiCol) &lt; 0)</span><br/>               <span style="color: #A0A0A0"> 288</span> <span style="color: #A0A0A0; background: #FFFFFF;">            [xiCol,p] = sort(xiCol);</span><br/>               <span style="color: #A0A0A0"> 289</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 290</span> <span style="color: #A0A0A0; background: #FFFFFF;">            p = 1:numelXi;</span><br/>               <span style="color: #A0A0A0"> 291</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 292</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 293</span> <span style="color: #228B22; background: #FFFFFF;">        % Find indices of subintervals, x(k) &lt;= u &lt; x(k+1),</span><br/>               <span style="color: #A0A0A0"> 294</span> <span style="color: #228B22; background: #FFFFFF;">        % or u &lt; x(1) or u &gt;= x(m-1).</span><br/>               <span style="color: #A0A0A0"> 295</span> <span style="color: #A0A0A0; background: #FFFFFF;">        if isempty(xiCol)</span><br/>               <span style="color: #A0A0A0"> 296</span> <span style="color: #A0A0A0; background: #FFFFFF;">            k = xiCol;</span><br/>               <span style="color: #A0A0A0"> 297</span> <span style="color: #A0A0A0; background: #FFFFFF;">        elseif eqsp</span><br/>               <span style="color: #A0A0A0"> 298</span> <span style="color: #A0A0A0; background: #FFFFFF;">            k = min(max(1+floor((xiCol-xCol(1))/h),1),n-1);</span><br/>               <span style="color: #A0A0A0"> 299</span> <span style="color: #228B22; background: #FFFFFF;">        else</span><br/>               <span style="color: #A0A0A0"> 300</span> <span style="color: #A0A0A0; background: #FFFFFF;">            [ignore,k] = histc(xiCol,xCol);</span><br/>               <span style="color: #A0A0A0"> 301</span> <span style="color: #A0A0A0; background: #FFFFFF;">            k(xiCol&lt;xCol(1) | ~isfinite(xiCol)) = 1;</span><br/>               <span style="color: #A0A0A0"> 302</span> <span style="color: #A0A0A0; background: #FFFFFF;">            k(xiCol&gt;=xCol(n)) = n-1;</span><br/>               <span style="color: #A0A0A0"> 303</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 304</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 305</span> <span style="color: #A0A0A0; background: #FFFFFF;">        switch method(1)</span><br/>               <span style="color: #A0A0A0"> 306</span> <span style="color: #A0A0A0; background: #FFFFFF;">            case 'n'  % 'nearest'</span><br/>               <span style="color: #A0A0A0"> 307</span> <span style="color: #A0A0A0; background: #FFFFFF;">                i = find(xiCol &gt;= (xCol(k)+xCol(k+1))/2);</span><br/>               <span style="color: #A0A0A0"> 308</span> <span style="color: #A0A0A0; background: #FFFFFF;">                k(i) = k(i)+1;</span><br/>               <span style="color: #A0A0A0"> 309</span> <span style="color: #A0A0A0; background: #FFFFFF;">                yiMat(p,:) = yMat(k,:);</span><br/>               <span style="color: #A0A0A0"> 310</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 311</span> <span style="color: #A0A0A0; background: #FFFFFF;">            case 'l'  % 'linear'</span><br/>               <span style="color: #A0A0A0"> 312</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if eqsp</span><br/>               <span style="color: #A0A0A0"> 313</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    s = (xiCol - xCol(k))/h;</span><br/>               <span style="color: #A0A0A0"> 314</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0"> 315</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    s = (xiCol - xCol(k))./h(k);</span><br/>               <span style="color: #A0A0A0"> 316</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 317</span> <span style="color: #A0A0A0; background: #FFFFFF;">                for j = 1:prodDs</span><br/>               <span style="color: #A0A0A0"> 318</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    yiMat(p,j) = yMat(k,j) + s.*(yMat(k+1,j)-yMat(k,j));</span><br/>               <span style="color: #A0A0A0"> 319</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 320</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 321</span> <span style="color: #A0A0A0; background: #FFFFFF;">            case 'v'  % 'v5cubic'</span><br/>               <span style="color: #A0A0A0"> 322</span> <span style="color: #A0A0A0; background: #FFFFFF;">                extrapval = NaN;</span><br/>               <span style="color: #A0A0A0"> 323</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if eqsp</span><br/>               <span style="color: #A0A0A0"> 324</span> <span style="color: #228B22; background: #FFFFFF;">                    % Data are equally spaced</span><br/>               <span style="color: #A0A0A0"> 325</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    s = (xiCol - xCol(k))/h;</span><br/>               <span style="color: #A0A0A0"> 326</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    s2 = s.*s;</span><br/>               <span style="color: #A0A0A0"> 327</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    s3 = s.*s2;</span><br/>               <span style="color: #A0A0A0"> 328</span> <span style="color: #228B22; background: #FFFFFF;">                    % Add extra points for first and last interval</span><br/>               <span style="color: #A0A0A0"> 329</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    yMat = [3*yMat(1,:)-3*yMat(2,:)+yMat(3,:); ...</span><br/>               <span style="color: #A0A0A0"> 330</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        yMat; ...</span><br/>               <span style="color: #A0A0A0"> 331</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        3*yMat(n,:)-3*yMat(n-1,:)+yMat(n-2,:)];</span><br/>               <span style="color: #A0A0A0"> 332</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    for j = 1:prodDs</span><br/>               <span style="color: #A0A0A0"> 333</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        yiMat(p,j) = (yMat(k,j).*(-s3+2*s2-s) + ...</span><br/>               <span style="color: #A0A0A0"> 334</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            yMat(k+1,j).*(3*s3-5*s2+2) + ...</span><br/>               <span style="color: #A0A0A0"> 335</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            yMat(k+2,j).*(-3*s3+4*s2+s) + ...</span><br/>               <span style="color: #A0A0A0"> 336</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            yMat(k+3,j).*(s3-s2))/2;</span><br/>               <span style="color: #A0A0A0"> 337</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0"> 338</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0"> 339</span> <span style="color: #228B22; background: #FFFFFF;">                    % Data are not equally spaced</span><br/>               <span style="color: #A0A0A0"> 340</span> <span style="color: #228B22; background: #FFFFFF;">                    % spline is oriented opposite to interp1</span><br/>               <span style="color: #A0A0A0"> 341</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    yiMat = spline(xCol.',yMat.',xiCol.').';</span><br/>               <span style="color: #A0A0A0"> 342</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 343</span> <span style="color: #A0A0A0; background: #FFFFFF;">            otherwise</span><br/>               <span style="color: #A0A0A0"> 344</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error('MATLAB:interp1:InvalidMethod','Invalid method.')</span><br/>               <span style="color: #A0A0A0"> 345</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 346</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 347</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 348</span> <span style="color: #228B22; background: #FFFFFF;">% Override extrapolation</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 349</span> <span style="color: #000000; background: #FFFFFF;">if ~isequal(extrapval,'extrap') </span><br/>               <span style="color: #A0A0A0"> 350</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if ischar(extrapval)</span><br/>               <span style="color: #A0A0A0"> 351</span> <span style="color: #A0A0A0; background: #FFFFFF;">        error('MATLAB:interp1:InvalidExtrap', 'Invalid extrap option.')</span><br/>               <span style="color: #A0A0A0"> 352</span> <span style="color: #A0A0A0; background: #FFFFFF;">    elseif ~isscalar(extrapval)</span><br/>               <span style="color: #A0A0A0"> 353</span> <span style="color: #A0A0A0; background: #FFFFFF;">        error('MATLAB:interp1:NonScalarExtrapValue',...</span><br/>               <span style="color: #A0A0A0"> 354</span> <span style="color: #A0A0A0; background: #FFFFFF;">            'EXTRAP option must be a scalar.')</span><br/>               <span style="color: #A0A0A0"> 355</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 356</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if isempty(p)</span><br/>               <span style="color: #A0A0A0"> 357</span> <span style="color: #A0A0A0; background: #FFFFFF;">        p = 1 : numelXi;</span><br/>               <span style="color: #A0A0A0"> 358</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 359</span> <span style="color: #A0A0A0; background: #FFFFFF;">     outOfBounds = xiCol&lt;xCol(1) | xiCol&gt;xCol(n);</span><br/>               <span style="color: #A0A0A0"> 360</span> <span style="color: #A0A0A0; background: #FFFFFF;">     yiMat(p(outOfBounds),:) = extrapval;</span><br/>               <span style="color: #A0A0A0"> 361</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 362</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 363</span> <span style="color: #228B22; background: #FFFFFF;">% Reshape result, possibly to an ND array</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 364</span> <span style="color: #000000; background: #FFFFFF;">yi = reshape(yiMat,siz_yi); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 365</span> <span style="color: #000000; background: #FFFFFF;">varargout{1} = yi; </span><br/>               <span style="color: #A0A0A0"> 366</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 367</span> <span style="color: #228B22; background: #FFFFFF;">%-------------------------------------------------------------------------%</span><br/>               <span style="color: #A0A0A0"> 368</span> <span style="color: #A0A0A0; background: #FFFFFF;">    function pp = ppinterp</span><br/>               <span style="color: #A0A0A0"> 369</span> <span style="color: #228B22; background: #FFFFFF;">        %PPINTERP ppform interpretation.</span><br/>               <span style="color: #A0A0A0"> 370</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 371</span> <span style="color: #A0A0A0; background: #FFFFFF;">        switch method(1)</span><br/>               <span style="color: #A0A0A0"> 372</span> <span style="color: #A0A0A0; background: #FFFFFF;">            case 'n' % nearest</span><br/>               <span style="color: #A0A0A0"> 373</span> <span style="color: #A0A0A0; background: #FFFFFF;">                breaks = [xCol(1); ...</span><br/>               <span style="color: #A0A0A0"> 374</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    (xCol(1:end-1)+xCol(2:end))/2; ...</span><br/>               <span style="color: #A0A0A0"> 375</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    xCol(end)].';</span><br/>               <span style="color: #A0A0A0"> 376</span> <span style="color: #A0A0A0; background: #FFFFFF;">                coefs = yMat.';</span><br/>               <span style="color: #A0A0A0"> 377</span> <span style="color: #A0A0A0; background: #FFFFFF;">                pp = mkpp(breaks,coefs,ds);</span><br/>               <span style="color: #A0A0A0"> 378</span> <span style="color: #A0A0A0; background: #FFFFFF;">            case 'l' % linear</span><br/>               <span style="color: #A0A0A0"> 379</span> <span style="color: #A0A0A0; background: #FFFFFF;">                breaks = xCol.';</span><br/>               <span style="color: #A0A0A0"> 380</span> <span style="color: #A0A0A0; background: #FFFFFF;">                page1 = (diff(yMat)./repmat(diff(xCol),[1, prodDs])).';</span><br/>               <span style="color: #A0A0A0"> 381</span> <span style="color: #A0A0A0; background: #FFFFFF;">                page2 = (reshape(yMat(1:end-1,:),[n-1, prodDs])).';</span><br/>               <span style="color: #A0A0A0"> 382</span> <span style="color: #A0A0A0; background: #FFFFFF;">                coefs = cat(3,page1,page2);</span><br/>               <span style="color: #A0A0A0"> 383</span> <span style="color: #A0A0A0; background: #FFFFFF;">                pp = mkpp(breaks,coefs,ds);</span><br/>               <span style="color: #A0A0A0"> 384</span> <span style="color: #A0A0A0; background: #FFFFFF;">            case {'p', 'c'} % pchip and cubic</span><br/>               <span style="color: #A0A0A0"> 385</span> <span style="color: #A0A0A0; background: #FFFFFF;">                pp = pchip(xCol.',reshape(yMat.',[ds, n]));</span><br/>               <span style="color: #A0A0A0"> 386</span> <span style="color: #A0A0A0; background: #FFFFFF;">            case 's' % spline</span><br/>               <span style="color: #A0A0A0"> 387</span> <span style="color: #A0A0A0; background: #FFFFFF;">                pp = spline(xCol.',reshape(yMat.',[ds, n]));</span><br/>               <span style="color: #A0A0A0"> 388</span> <span style="color: #A0A0A0; background: #FFFFFF;">            case 'v' % v5cubic</span><br/>               <span style="color: #A0A0A0"> 389</span> <span style="color: #A0A0A0; background: #FFFFFF;">                b = diff(xCol);</span><br/>               <span style="color: #A0A0A0"> 390</span> <span style="color: #A0A0A0; background: #FFFFFF;">                if norm(diff(b),Inf) &lt;= eps(norm(xCol,Inf))</span><br/>               <span style="color: #A0A0A0"> 391</span> <span style="color: #228B22; background: #FFFFFF;">                    % data are equally spaced</span><br/>               <span style="color: #A0A0A0"> 392</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    a = repmat(b,[1 prodDs]).';</span><br/>               <span style="color: #A0A0A0"> 393</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    yReorg = [3*yMat(1,:)-3*yMat(2,:)+yMat(3,:); ...</span><br/>               <span style="color: #A0A0A0"> 394</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        yMat; ...</span><br/>               <span style="color: #A0A0A0"> 395</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        3*yMat(n,:)-3*yMat(n-1,:)+yMat(n-2,:)];</span><br/>               <span style="color: #A0A0A0"> 396</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    y1 = yReorg(1:end-3,:).';</span><br/>               <span style="color: #A0A0A0"> 397</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    y2 = yReorg(2:end-2,:).';</span><br/>               <span style="color: #A0A0A0"> 398</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    y3 = yReorg(3:end-1,:).';</span><br/>               <span style="color: #A0A0A0"> 399</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    y4 = yReorg(4:end,:).';</span><br/>               <span style="color: #A0A0A0"> 400</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    breaks = xCol.';</span><br/>               <span style="color: #A0A0A0"> 401</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    page1 = (-y1+3*y2-3*y3+y4)./(2*a.^3);</span><br/>               <span style="color: #A0A0A0"> 402</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    page2 = (2*y1-5*y2+4*y3-y4)./(2*a.^2);</span><br/>               <span style="color: #A0A0A0"> 403</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    page3 = (-y1+y3)./(2*a);</span><br/>               <span style="color: #A0A0A0"> 404</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    page4 = y2;</span><br/>               <span style="color: #A0A0A0"> 405</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    coefs = cat(3,page1,page2,page3,page4);</span><br/>               <span style="color: #A0A0A0"> 406</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    pp = mkpp(breaks,coefs,ds);</span><br/>               <span style="color: #A0A0A0"> 407</span> <span style="color: #228B22; background: #FFFFFF;">                else</span><br/>               <span style="color: #A0A0A0"> 408</span> <span style="color: #228B22; background: #FFFFFF;">                    % data are not equally spaced</span><br/>               <span style="color: #A0A0A0"> 409</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    pp = spline(xCol.',reshape(yMat.',[ds, n]));</span><br/>               <span style="color: #A0A0A0"> 410</span> <span style="color: #A0A0A0; background: #FFFFFF;">                end</span><br/>               <span style="color: #A0A0A0"> 411</span> <span style="color: #A0A0A0; background: #FFFFFF;">            otherwise</span><br/>               <span style="color: #A0A0A0"> 412</span> <span style="color: #A0A0A0; background: #FFFFFF;">                error('MATLAB:interp1:ppinterp:UnknownMethod', ...</span><br/>               <span style="color: #A0A0A0"> 413</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    'Unrecognized method.');</span><br/>               <span style="color: #A0A0A0"> 414</span> <span style="color: #A0A0A0; background: #FFFFFF;">        end</span><br/>               <span style="color: #A0A0A0"> 415</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 416</span> <span style="color: #228B22; background: #FFFFFF;">        % Even if method is 'spline' or 'pchip', we still need to record that the</span><br/>               <span style="color: #A0A0A0"> 417</span> <span style="color: #228B22; background: #FFFFFF;">        % input data Y was oriented according to INTERP1's rules.</span><br/>               <span style="color: #A0A0A0"> 418</span> <span style="color: #228B22; background: #FFFFFF;">        % Thus PPVAL will return YI oriented according to INTERP1's rules and</span><br/>               <span style="color: #A0A0A0"> 419</span> <span style="color: #228B22; background: #FFFFFF;">        % YI = INTERP1(X,Y,XI,METHOD) will be the same as</span><br/>               <span style="color: #A0A0A0"> 420</span> <span style="color: #228B22; background: #FFFFFF;">        % YI = PPVAL(INTERP1(X,Y,METHOD,'pp'),XI)</span><br/>               <span style="color: #A0A0A0"> 421</span> <span style="color: #A0A0A0; background: #FFFFFF;">        pp.orient = 'first';</span><br/>               <span style="color: #A0A0A0"> 422</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end % PPINTERP</span><br/>               <span style="color: #A0A0A0"> 423</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      4 </span><span style="color: #000000; font-weight: bold"> 424</span> <span style="color: #000000; background: #FFFFFF;">end % INTERP1 </span><br/></pre></body></html>