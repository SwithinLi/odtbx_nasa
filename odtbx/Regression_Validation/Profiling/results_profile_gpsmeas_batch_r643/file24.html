<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><link rel="stylesheet" href="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\matlab-report-styles.css" type="text/css" /><title>Function details for read_yuma</title><link rel="stylesheet" href="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">read_yuma (1 call, 0.040 sec)</span><br/><i>Generated 29-May-2009 12:06:26 using cpu time.</i><br/>M-function in file C:\Users\abrown\Projects\ODTBX\matlab\trunk\ODTBX_Source\read_yuma.m<br/>[Copy to new window for comparing multiple runs]<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td></tr><tr><td class="td-linebottomrt"><a href="file20.html">gpsmeas</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">1</td></tr></table><div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line59">59</a></td><td class="td-linebottomrt"><pre>number(i) = str2num(line(27:si...</pre></td><td class="td-linebottomrt">377</td><td class="td-linebottomrt">0.017 s</td><td class="td-linebottomrt" class="td-linebottomrt">42.7%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=43 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line71">71</a></td><td class="td-linebottomrt"><pre>tgps_now = floor(convertTime('...</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.010 s</td><td class="td-linebottomrt" class="td-linebottomrt">23.5%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=24 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line57">57</a></td><td class="td-linebottomrt"><pre>line = fgetl(fid);</pre></td><td class="td-linebottomrt">377</td><td class="td-linebottomrt">0.009 s</td><td class="td-linebottomrt" class="td-linebottomrt">23.4%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=23 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line62">62</a></td><td class="td-linebottomrt"><pre>line = fgetl(fid);</pre></td><td class="td-linebottomrt">57</td><td class="td-linebottomrt">0.001 s</td><td class="td-linebottomrt" class="td-linebottomrt">3.2%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=3 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line50">50</a></td><td class="td-linebottomrt"><pre>fid = fopen(fn,'r');</pre></td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.001 s</td><td class="td-linebottomrt" class="td-linebottomrt">2.6%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=3 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.002 s</td><td class="td-linebottomrt">4.6%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=5 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">0.040 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file47.html">str2num</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">377</td><td class="td-linebottomrt">0.015 s</td><td class="td-linebottomrt">36.9%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=37 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file46.html">fgetl</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">435</td><td class="td-linebottomrt">0.010 s</td><td class="td-linebottomrt">24.2%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=24 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file23.html">convertTime</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.008 s</td><td class="td-linebottomrt">19.4%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=19 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file19.html">datenum</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0.002 s</td><td class="td-linebottomrt">4.1%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=4 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.006 s</td><td class="td-linebottomrt">15.5%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=16 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">0.040 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>M-Lint results</strong><br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Message</td></tr><tr><td class="td-linebottomrt"><a href="#Line59">59</a></td><td class="td-linebottomrt"><span class="mono">'number' might be growing inside a loop. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line59">59</a></td><td class="td-linebottomrt"><span class="mono">STR2DOUBLE is faster than STR2NUM, however STR2DOUBLE operates only on scalars. Use the function that best suits your needs.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line86">86</a></td><td class="td-linebottomrt"><span class="mono">It appears this statement is never executed.</span></td></tr></table><div class="grayline"/><strong>Coverage results</strong><br/>[ Show coverage for parent directory ]<br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td><td class="td-linebottomrt">153</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">71</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">82</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">26</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">56</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">31.71 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><pre> <span style="color: #FF0000; font-weight: bold; text-decoration: none">  time</span> <span style="color: #0000FF; font-weight: bold; text-decoration: none">  calls</span>  <span style="font-weight: bold; text-decoration: none">line</span><br/>               <span style="color: #A0A0A0">   1</span> <span style="color: #A0A0A0; background: #FFFFFF;">function [alm] = read_yuma(fn,forceweek,toplot)</span><br/>               <span style="color: #A0A0A0">   2</span> <span style="color: #228B22; background: #FFFFFF;">% READ_YUMA  Read in yuma format GPS almanac file</span><br/>               <span style="color: #A0A0A0">   3</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">   4</span> <span style="color: #228B22; background: #FFFFFF;">%   [alm] = read_yuma(fn,forceweek,toplot)</span><br/>               <span style="color: #A0A0A0">   5</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">   6</span> <span style="color: #228B22; background: #FFFFFF;">% Read in yuma format GPS almanac file.</span><br/>               <span style="color: #A0A0A0">   7</span> <span style="color: #228B22; background: #FFFFFF;">% Updates the modulo 1024 GPS week number to the full GPS week</span><br/>               <span style="color: #A0A0A0">   8</span> <span style="color: #228B22; background: #FFFFFF;">% that corresponds closest to the PC clock.  (I.E. when executed</span><br/>               <span style="color: #A0A0A0">   9</span> <span style="color: #228B22; background: #FFFFFF;">% in 2002, week 100 would be interpreted as starting 7/21/2001,</span><br/>               <span style="color: #A0A0A0">  10</span> <span style="color: #228B22; background: #FFFFFF;">% not 12/6/1981.</span><br/>               <span style="color: #A0A0A0">  11</span> <span style="color: #228B22; background: #FFFFFF;">% Echo summary of almanac data to display.</span><br/>               <span style="color: #A0A0A0">  12</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  13</span> <span style="color: #228B22; background: #FFFFFF;">% Input:   fn  - name of yuma formatted almanac file\</span><br/>               <span style="color: #A0A0A0">  14</span> <span style="color: #228B22; background: #FFFFFF;">%          forceweek - if 1, force it to use the actual week number in the file (no check for roll-over)</span><br/>               <span style="color: #A0A0A0">  15</span> <span style="color: #228B22; background: #FFFFFF;">%          toplot - 1 - plot almanac data with svmap, 2 plot w/o sv map,  0 - no plots</span><br/>               <span style="color: #A0A0A0">  16</span> <span style="color: #228B22; background: #FFFFFF;">% Output:  alm - [n,13] matrix containing gps almanac data</span><br/>               <span style="color: #A0A0A0">  17</span> <span style="color: #228B22; background: #FFFFFF;">%          columns of almanac matrix are:</span><br/>               <span style="color: #A0A0A0">  18</span> <span style="color: #228B22; background: #FFFFFF;">%             PRN</span><br/>               <span style="color: #A0A0A0">  19</span> <span style="color: #228B22; background: #FFFFFF;">%             Health</span><br/>               <span style="color: #A0A0A0">  20</span> <span style="color: #228B22; background: #FFFFFF;">%             Eccentricity</span><br/>               <span style="color: #A0A0A0">  21</span> <span style="color: #228B22; background: #FFFFFF;">%             Time of Applicability  [seconds of week]</span><br/>               <span style="color: #A0A0A0">  22</span> <span style="color: #228B22; background: #FFFFFF;">%             Inclination [rad]</span><br/>               <span style="color: #A0A0A0">  23</span> <span style="color: #228B22; background: #FFFFFF;">%             Rate of Right Ascen [rad/s]</span><br/>               <span style="color: #A0A0A0">  24</span> <span style="color: #228B22; background: #FFFFFF;">%             SQRT(A)  [km^1/2]</span><br/>               <span style="color: #A0A0A0">  25</span> <span style="color: #228B22; background: #FFFFFF;">%             Longitude of Asc Node at weekly epoch [rad]</span><br/>               <span style="color: #A0A0A0">  26</span> <span style="color: #228B22; background: #FFFFFF;">%             Argument of Perigee [rad]</span><br/>               <span style="color: #A0A0A0">  27</span> <span style="color: #228B22; background: #FFFFFF;">%             Mean Anom [rad]</span><br/>               <span style="color: #A0A0A0">  28</span> <span style="color: #228B22; background: #FFFFFF;">%             Af0 [s]</span><br/>               <span style="color: #A0A0A0">  29</span> <span style="color: #228B22; background: #FFFFFF;">%             Af1 [s/s]</span><br/>               <span style="color: #A0A0A0">  30</span> <span style="color: #228B22; background: #FFFFFF;">%             gps week (might be modulo 1023)</span><br/>               <span style="color: #A0A0A0">  31</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  32</span> <span style="color: #228B22; background: #FFFFFF;">%  REVISION HISTORY</span><br/>               <span style="color: #A0A0A0">  33</span> <span style="color: #228B22; background: #FFFFFF;">%   Author      		Date         	Comment</span><br/>               <span style="color: #A0A0A0">  34</span> <span style="color: #228B22; background: #FFFFFF;">%   Mike Moreau         05/2002         Original</span><br/>               <span style="color: #A0A0A0">  35</span> <span style="color: #228B22; background: #FFFFFF;">%   Mike Moreau         06/2003         Updated</span><br/>               <span style="color: #A0A0A0">  36</span> <span style="color: #228B22; background: #FFFFFF;">%   Kevin Berry         09/2007         Modified for ODTBX</span><br/>               <span style="color: #A0A0A0">  37</span> <span style="color: #228B22; background: #FFFFFF;">%   Keith Speckman      03/15/2008      Minor comment change</span><br/>               <span style="color: #A0A0A0">  38</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  39</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  40</span> <span style="color: #000000; background: #FFFFFF;">if nargin &lt; 3 </span><br/>               <span style="color: #A0A0A0">  41</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  42</span> <span style="color: #A0A0A0; background: #FFFFFF;">    forceweek = 0;  % By default, add week roll-overs to given week number based on current date</span><br/>               <span style="color: #A0A0A0">  43</span> <span style="color: #A0A0A0; background: #FFFFFF;">    toplot = 0;</span><br/>               <span style="color: #A0A0A0">  44</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  45</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if nargin &lt; 1</span><br/>               <span style="color: #A0A0A0">  46</span> <span style="color: #A0A0A0; background: #FFFFFF;">        fn = input('Enter YUMA GPS almanac file: ','s');</span><br/>               <span style="color: #A0A0A0">  47</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0">  48</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0">  49</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  50</span> <a name="Line50"></a><span style="color: #000000; background: #FFFFFF;">fid = fopen(fn,'r'); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  51</span> <span style="color: #000000; background: #FFFFFF;">i = 0; </span><br/>               <span style="color: #A0A0A0">  52</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  53</span> <span style="color: #000000; background: #FFFFFF;">line = <a href="file46.html">fgetl</a>(fid); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  54</span> <span style="color: #000000; background: #FFFFFF;">while feof(fid) == 0 </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">     57 </span><span style="color: #000000; font-weight: bold">  55</span> <span style="color: #000000; background: #FFFFFF;">    if length(line)&gt;4  &amp;&amp;  strcmp(line(1:4),'****') </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">     29 </span><span style="color: #000000; font-weight: bold">  56</span> <span style="color: #000000; background: #FFFFFF;">        for count = 1:13 </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">    377 </span><span style="color: #000000; font-weight: bold">  57</span> <a name="Line57"></a><span style="color: #000000; background: #FFB8B8;">            line = <a href="file46.html">fgetl</a>(fid); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">    377 </span><span style="color: #000000; font-weight: bold">  58</span> <span style="color: #000000; background: #FFFFFF;">            i = i+1; </span><br/><a name="Line59"></a><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">    377 </span><span style="color: #000000; font-weight: bold">  59</span> <a name="Line59"></a><span style="color: #000000; background: #FF8080;">            number(i) = <a href="file47.html">str2num</a>(line(27:size(line,2))); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">    377 </span><span style="color: #000000; font-weight: bold">  60</span> <span style="color: #000000; background: #FFFFFF;">        end </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">     29 </span><span style="color: #000000; font-weight: bold">  61</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">     57 </span><span style="color: #000000; font-weight: bold">  62</span> <a name="Line62"></a><span style="color: #000000; background: #FFFFFF;">    line = <a href="file46.html">fgetl</a>(fid); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">     57 </span><span style="color: #000000; font-weight: bold">  63</span> <span style="color: #000000; background: #FFFFFF;">end  % while </span><br/>               <span style="color: #A0A0A0">  64</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  65</span> <span style="color: #000000; background: #FFFFFF;">fclose(fid); </span><br/>               <span style="color: #A0A0A0">  66</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  67</span> <span style="color: #000000; background: #FFFFFF;">alm = reshape(number',13,size(number,2)/13)'; </span><br/>               <span style="color: #A0A0A0">  68</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  69</span> <span style="color: #228B22; background: #FFFFFF;">% Check for GPS week rollover</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  70</span> <span style="color: #000000; background: #FFFFFF;">if ~forceweek </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  71</span> <a name="Line71"></a><span style="color: #000000; background: #FFB8B8;">    tgps_now = floor(<a href="file23.html">convertTime</a>('GPS','UTC', <a href="file19.html">datenum</a>(clock))/7); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  72</span> <span style="color: #000000; background: #FFFFFF;">    diff = tgps_now(1) - alm(1,13); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  73</span> <span style="color: #000000; background: #FFFFFF;">    while diff &gt; 512 </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  74</span> <span style="color: #000000; background: #FFFFFF;">        alm(:,13) = alm(:,13) + 1024; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  75</span> <span style="color: #000000; background: #FFFFFF;">        diff = tgps_now(1) - alm(1,13); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  76</span> <span style="color: #000000; background: #FFFFFF;">    end </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  77</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0">  78</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  79</span> <span style="color: #228B22; background: #FFFFFF;">% Convert SQRT(A) from m^1/2 to km^1/2</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  80</span> <span style="color: #000000; background: #FFFFFF;">alm(:,7)=alm(:,7)*(1e-3)^(1/2); </span><br/>               <span style="color: #A0A0A0">  81</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  82</span> <span style="color: #000000; background: #FFFFFF;">if toplot </span><br/>               <span style="color: #A0A0A0">  83</span> <span style="color: #A0A0A0; background: #FFFFFF;">    disp('yuma plotting function doesn''t work yet')</span><br/>               <span style="color: #A0A0A0">  84</span> <span style="color: #A0A0A0; background: #FFFFFF;">    disp('there are still a few functions needed that aren''t in ODTBX')</span><br/>               <span style="color: #A0A0A0">  85</span> <span style="color: #A0A0A0; background: #FFFFFF;">end, return %this line should be removed when it works</span><br/><a name="Line86"></a>               <span style="color: #A0A0A0">  86</span> <span style="color: #A0A0A0; background: #FFFFFF;">toe = alm(:,4);               % time of reference ephemeris</span><br/>               <span style="color: #A0A0A0">  87</span> <span style="color: #A0A0A0; background: #FFFFFF;">M_not = alm(:,10);            % mean anomaly at toe</span><br/>               <span style="color: #A0A0A0">  88</span> <span style="color: #A0A0A0; background: #FFFFFF;">ecc = alm(:,3);               % eccentricity</span><br/>               <span style="color: #A0A0A0">  89</span> <span style="color: #A0A0A0; background: #FFFFFF;">arg_peri = alm(:,9);          % argument of periapsis</span><br/>               <span style="color: #A0A0A0">  90</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  91</span> <span style="color: #228B22; background: #FFFFFF;">%Conversion matrix from PRN to SVN</span><br/>               <span style="color: #A0A0A0">  92</span> <span style="color: #A0A0A0; background: #FFFFFF;">SVmatrix = [32;61;33;34;35;36;37;38;39;40;46;42;43;41;15;56;...</span><br/>               <span style="color: #A0A0A0">  93</span> <span style="color: #A0A0A0; background: #FFFFFF;">    0;54;59;51;45;47;60;24;25;26;27;44;29;30;31;0];</span><br/>               <span style="color: #A0A0A0">  94</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  95</span> <span style="color: #228B22; background: #FFFFFF;">% Compute arg of latitude of each PRN</span><br/>               <span style="color: #A0A0A0">  96</span> <span style="color: #A0A0A0; background: #FFFFFF;">for i = 1:size(alm,1)  % Start loop through each prn</span><br/>               <span style="color: #A0A0A0">  97</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  98</span> <span style="color: #A0A0A0; background: #FFFFFF;">    M_k = M_not(i);</span><br/>               <span style="color: #A0A0A0">  99</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 100</span> <span style="color: #228B22; background: #FFFFFF;">    % Iterate to find eccentric anomaly.</span><br/>               <span style="color: #A0A0A0"> 101</span> <span style="color: #228B22; background: #FFFFFF;">    % Use M_k as initial guess for E.</span><br/>               <span style="color: #A0A0A0"> 102</span> <span style="color: #228B22; background: #FFFFFF;">    % All PRNs iterated the same ammount, some may converge earlier</span><br/>               <span style="color: #A0A0A0"> 103</span> <span style="color: #228B22; background: #FFFFFF;">    % than others, but there is no logic to loof for that.</span><br/>               <span style="color: #A0A0A0"> 104</span> <span style="color: #A0A0A0; background: #FFFFFF;">    E = M_k;                      % First guess for E</span><br/>               <span style="color: #A0A0A0"> 105</span> <span style="color: #A0A0A0; background: #FFFFFF;">    E_old = E+1;                  % Set E-old for at least one loop</span><br/>               <span style="color: #A0A0A0"> 106</span> <span style="color: #A0A0A0; background: #FFFFFF;">    while sum(abs(E - E_old) &gt;= 0.0000000005) &gt; 0</span><br/>               <span style="color: #A0A0A0"> 107</span> <span style="color: #A0A0A0; background: #FFFFFF;">        E_old = E;</span><br/>               <span style="color: #A0A0A0"> 108</span> <span style="color: #A0A0A0; background: #FFFFFF;">        E = M_k + (ecc(i).*sin(E_old));</span><br/>               <span style="color: #A0A0A0"> 109</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 110</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 111</span> <span style="color: #228B22; background: #FFFFFF;">    % true anomaly as a function of eccentric anomaly</span><br/>               <span style="color: #A0A0A0"> 112</span> <span style="color: #A0A0A0; background: #FFFFFF;">    v = atan2(((sqrt(1 - ecc(i).^2)).*sin(E)),(cos(E) - ecc(i)));</span><br/>               <span style="color: #A0A0A0"> 113</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 114</span> <span style="color: #A0A0A0; background: #FFFFFF;">    phi(i) = v + arg_peri(i);		      % argument of latitude</span><br/>               <span style="color: #A0A0A0"> 115</span> <span style="color: #A0A0A0; background: #FFFFFF;">    SVN(i) = SVmatrix(alm(i,1));</span><br/>               <span style="color: #A0A0A0"> 116</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 117</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 118</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 119</span> <span style="color: #A0A0A0; background: #FFFFFF;">figure</span><br/>               <span style="color: #A0A0A0"> 120</span> <span style="color: #A0A0A0; background: #FFFFFF;">raan = r2d(gpslan2raan(alm(:,8),alm(:,13)));</span><br/>               <span style="color: #A0A0A0"> 121</span> <span style="color: #A0A0A0; background: #FFFFFF;">ma = r2d(alm(:,10));</span><br/>               <span style="color: #A0A0A0"> 122</span> <span style="color: #A0A0A0; background: #FFFFFF;">ma(find(ma&gt;180)) = ma(find(ma&gt;180))-360;</span><br/>               <span style="color: #A0A0A0"> 123</span> <span style="color: #A0A0A0; background: #FFFFFF;">argp = r2d(alm(:,9));</span><br/>               <span style="color: #A0A0A0"> 124</span> <span style="color: #A0A0A0; background: #FFFFFF;">argp(find(argp&gt;180)) = argp(find(argp&gt;180))-360;</span><br/>               <span style="color: #A0A0A0"> 125</span> <span style="color: #A0A0A0; background: #FFFFFF;">phi = r2d(phi)';</span><br/>               <span style="color: #A0A0A0"> 126</span> <span style="color: #A0A0A0; background: #FFFFFF;">phi(find(phi&gt;180)) = phi(find(phi&gt;180))-360;</span><br/>               <span style="color: #A0A0A0"> 127</span> <span style="color: #A0A0A0; background: #FFFFFF;">phi(find(phi&lt;-180)) = phi(find(phi&lt;-180))+360;</span><br/>               <span style="color: #A0A0A0"> 128</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 129</span> <span style="color: #A0A0A0; background: #FFFFFF;">xarg = raan;</span><br/>               <span style="color: #A0A0A0"> 130</span> <span style="color: #228B22; background: #FFFFFF;">%yarg = ma;</span><br/>               <span style="color: #A0A0A0"> 131</span> <span style="color: #228B22; background: #FFFFFF;">%yarg = argp;</span><br/>               <span style="color: #A0A0A0"> 132</span> <span style="color: #A0A0A0; background: #FFFFFF;">yarg = phi;</span><br/>               <span style="color: #A0A0A0"> 133</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 134</span> <span style="color: #A0A0A0; background: #FFFFFF;">ind = find(~alm(:,2));</span><br/>               <span style="color: #A0A0A0"> 135</span> <span style="color: #A0A0A0; background: #FFFFFF;">plot(xarg(ind),yarg(ind),'b*')</span><br/>               <span style="color: #A0A0A0"> 136</span> <span style="color: #A0A0A0; background: #FFFFFF;">hold on</span><br/>               <span style="color: #A0A0A0"> 137</span> <span style="color: #A0A0A0; background: #FFFFFF;">ind = find(alm(:,2));</span><br/>               <span style="color: #A0A0A0"> 138</span> <span style="color: #A0A0A0; background: #FFFFFF;">plot(xarg(ind),yarg(ind),'r*')</span><br/>               <span style="color: #A0A0A0"> 139</span> <span style="color: #A0A0A0; background: #FFFFFF;">hold off</span><br/>               <span style="color: #A0A0A0"> 140</span> <span style="color: #A0A0A0; background: #FFFFFF;">ylabel('Arg of Latitude')</span><br/>               <span style="color: #A0A0A0"> 141</span> <span style="color: #A0A0A0; background: #FFFFFF;">xlabel('Right Ascension Node')</span><br/>               <span style="color: #A0A0A0"> 142</span> <span style="color: #A0A0A0; background: #FFFFFF;">title(strrep(sprintf('Almanac: %s',fn),'_','\_'));</span><br/>               <span style="color: #A0A0A0"> 143</span> <span style="color: #A0A0A0; background: #FFFFFF;">axis([0,360,-180,180])</span><br/>               <span style="color: #A0A0A0"> 144</span> <span style="color: #A0A0A0; background: #FFFFFF;">for i = 1:length(SVN)</span><br/>               <span style="color: #A0A0A0"> 145</span> <span style="color: #A0A0A0; background: #FFFFFF;">    if toplot == 1</span><br/>               <span style="color: #A0A0A0"> 146</span> <span style="color: #A0A0A0; background: #FFFFFF;">        t= text(xarg(i)+5,yarg(i),sprintf('%d(%d)',alm(i,1),SVN(i)));</span><br/>               <span style="color: #A0A0A0"> 147</span> <span style="color: #A0A0A0; background: #FFFFFF;">    elseif toplot == 2</span><br/>               <span style="color: #A0A0A0"> 148</span> <span style="color: #A0A0A0; background: #FFFFFF;">        t= text(xarg(i)+5,yarg(i),sprintf('%d',alm(i,1)));</span><br/>               <span style="color: #A0A0A0"> 149</span> <span style="color: #A0A0A0; background: #FFFFFF;">    end</span><br/>               <span style="color: #A0A0A0"> 150</span> <span style="color: #A0A0A0; background: #FFFFFF;">    set(t,'FontSize',8)</span><br/>               <span style="color: #A0A0A0"> 151</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/>               <span style="color: #A0A0A0"> 152</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 153</span> <span style="color: #A0A0A0; background: #FFFFFF;">end</span><br/></pre></body></html>