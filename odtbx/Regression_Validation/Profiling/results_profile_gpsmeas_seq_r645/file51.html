<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /><link rel="stylesheet" href="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\matlab-report-styles.css" type="text/css" /><title>Function details for spline</title><link rel="stylesheet" href="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">spline (2884 calls, 2.720 sec)</span><br/><i>Generated 29-May-2009 12:20:29 using cpu time.</i><br/>M-function in file C:\Program Files\MATLAB\R2008a\toolbox\matlab\polyfun\spline.m<br/>[Copy to new window for comparing multiple runs]<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td></tr><tr><td class="td-linebottomrt"><a href="file59.html">interp1</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">2884</td></tr></table><div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line84">84</a></td><td class="td-linebottomrt"><pre>c = spdiags([ [x31;dxt(1:n-2);...</pre></td><td class="td-linebottomrt">2884</td><td class="td-linebottomrt">0.484 s</td><td class="td-linebottomrt" class="td-linebottomrt">17.8%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=18 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line90">90</a></td><td class="td-linebottomrt"><pre>spparms('autommd',0);</pre></td><td class="td-linebottomrt">2884</td><td class="td-linebottomrt">0.439 s</td><td class="td-linebottomrt" class="td-linebottomrt">16.2%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=16 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line96">96</a></td><td class="td-linebottomrt"><pre>pp = pwch(x,y,s,dx,divdif); pp...</pre></td><td class="td-linebottomrt">2884</td><td class="td-linebottomrt">0.410 s</td><td class="td-linebottomrt" class="td-linebottomrt">15.1%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=15 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line92">92</a></td><td class="td-linebottomrt"><pre>spparms('autommd',mmdflag);</pre></td><td class="td-linebottomrt">2884</td><td class="td-linebottomrt">0.389 s</td><td class="td-linebottomrt" class="td-linebottomrt">14.3%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=14 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line100">100</a></td><td class="td-linebottomrt"><pre>if nargin==2, output = pp; els...</pre></td><td class="td-linebottomrt">2884</td><td class="td-linebottomrt">0.350 s</td><td class="td-linebottomrt" class="td-linebottomrt">12.9%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=13 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.648 s</td><td class="td-linebottomrt">23.8%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=24 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">2.720 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file54.html">spparms</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">8652</td><td class="td-linebottomrt">0.966 s</td><td class="td-linebottomrt">35.5%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=35 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file37.html">pwch</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">2884</td><td class="td-linebottomrt">0.394 s</td><td class="td-linebottomrt">14.5%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=15 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file53.html">spdiags</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">2884</td><td class="td-linebottomrt">0.365 s</td><td class="td-linebottomrt">13.4%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=13 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file56.html">ppval</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">2884</td><td class="td-linebottomrt">0.330 s</td><td class="td-linebottomrt">12.1%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=12 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file52.html">polyfun\private\chckxy</a></td><td class="td-linebottomrt">M-function</td><td class="td-linebottomrt">2884</td><td class="td-linebottomrt">0.214 s</td><td class="td-linebottomrt">7.9%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=8 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.451 s</td><td class="td-linebottomrt">16.6%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files\MATLAB\R2008a\toolbox\matlab\codetools\private\one-pixel.gif" width=17 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">2.720 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>M-Lint results</strong><br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Message</td></tr><tr><td class="td-linebottomrt"><a href="#Line52">52</a></td><td class="td-linebottomrt"><span class="mono">The value assigned here to variable 'output' might never be used.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line69">69</a></td><td class="td-linebottomrt"><span class="mono">Use the DIMENSION input argument to DIFF instead of using transpose ('), and transpose the result if needed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line85">85</a></td><td class="td-linebottomrt"><span class="mono">Use of brackets [] is unnecessary.  Use parentheses to group, if needed.</span></td></tr></table><div class="grayline"/><strong>Coverage results</strong><br/>[ Show coverage for parent directory ]<br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td><td class="td-linebottomrt">100</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">66</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">34</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">22</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">12</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">64.71 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><pre> <span style="color: #FF0000; font-weight: bold; text-decoration: none">  time</span> <span style="color: #0000FF; font-weight: bold; text-decoration: none">  calls</span>  <span style="font-weight: bold; text-decoration: none">line</span><br/>               <span style="color: #A0A0A0">   1</span> <span style="color: #A0A0A0; background: #FFFFFF;">function output = spline(x,y,xx)</span><br/>               <span style="color: #A0A0A0">   2</span> <span style="color: #228B22; background: #FFFFFF;">%SPLINE Cubic spline data interpolation.</span><br/>               <span style="color: #A0A0A0">   3</span> <span style="color: #228B22; background: #FFFFFF;">%   PP = SPLINE(X,Y) provides the piecewise polynomial form of the </span><br/>               <span style="color: #A0A0A0">   4</span> <span style="color: #228B22; background: #FFFFFF;">%   cubic spline interpolant to the data values Y at the data sites X,</span><br/>               <span style="color: #A0A0A0">   5</span> <span style="color: #228B22; background: #FFFFFF;">%   for use with the evaluator PPVAL and the spline utility UNMKPP.</span><br/>               <span style="color: #A0A0A0">   6</span> <span style="color: #228B22; background: #FFFFFF;">%   X must be a vector.</span><br/>               <span style="color: #A0A0A0">   7</span> <span style="color: #228B22; background: #FFFFFF;">%   If Y is a vector, then Y(j) is taken as the value to be matched at X(j), </span><br/>               <span style="color: #A0A0A0">   8</span> <span style="color: #228B22; background: #FFFFFF;">%   hence Y must be of the same length as X  -- see below for an exception</span><br/>               <span style="color: #A0A0A0">   9</span> <span style="color: #228B22; background: #FFFFFF;">%   to this.</span><br/>               <span style="color: #A0A0A0">  10</span> <span style="color: #228B22; background: #FFFFFF;">%   If Y is a matrix or ND array, then Y(:,...,:,j) is taken as the value to</span><br/>               <span style="color: #A0A0A0">  11</span> <span style="color: #228B22; background: #FFFFFF;">%   be matched at X(j),  hence the last dimension of Y must equal length(X) --</span><br/>               <span style="color: #A0A0A0">  12</span> <span style="color: #228B22; background: #FFFFFF;">%   see below for an exception to this.</span><br/>               <span style="color: #A0A0A0">  13</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  14</span> <span style="color: #228B22; background: #FFFFFF;">%   YY = SPLINE(X,Y,XX) is the same as  YY = PPVAL(SPLINE(X,Y),XX), thus</span><br/>               <span style="color: #A0A0A0">  15</span> <span style="color: #228B22; background: #FFFFFF;">%   providing, in YY, the values of the interpolant at XX.  For information</span><br/>               <span style="color: #A0A0A0">  16</span> <span style="color: #228B22; background: #FFFFFF;">%   regarding the size of YY see PPVAL.</span><br/>               <span style="color: #A0A0A0">  17</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  18</span> <span style="color: #228B22; background: #FFFFFF;">%   Ordinarily, the not-a-knot end conditions are used. However, if Y contains</span><br/>               <span style="color: #A0A0A0">  19</span> <span style="color: #228B22; background: #FFFFFF;">%   two more values than X has entries, then the first and last value in Y are</span><br/>               <span style="color: #A0A0A0">  20</span> <span style="color: #228B22; background: #FFFFFF;">%   used as the endslopes for the cubic spline.  If Y is a vector, this</span><br/>               <span style="color: #A0A0A0">  21</span> <span style="color: #228B22; background: #FFFFFF;">%   means:</span><br/>               <span style="color: #A0A0A0">  22</span> <span style="color: #228B22; background: #FFFFFF;">%       f(X) = Y(2:end-1),  Df(min(X))=Y(1),    Df(max(X))=Y(end).</span><br/>               <span style="color: #A0A0A0">  23</span> <span style="color: #228B22; background: #FFFFFF;">%   If Y is a matrix or N-D array with SIZE(Y,N) equal to LENGTH(X)+2, then</span><br/>               <span style="color: #A0A0A0">  24</span> <span style="color: #228B22; background: #FFFFFF;">%   f(X(j)) matches the value Y(:,...,:,j+1) for j=1:LENGTH(X), then</span><br/>               <span style="color: #A0A0A0">  25</span> <span style="color: #228B22; background: #FFFFFF;">%   Df(min(X)) matches Y(:,:,...:,1) and Df(max(X)) matches Y(:,:,...:,end).</span><br/>               <span style="color: #A0A0A0">  26</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  27</span> <span style="color: #228B22; background: #FFFFFF;">%   Example:</span><br/>               <span style="color: #A0A0A0">  28</span> <span style="color: #228B22; background: #FFFFFF;">%   This generates a sine-like spline curve and samples it over a finer mesh:</span><br/>               <span style="color: #A0A0A0">  29</span> <span style="color: #228B22; background: #FFFFFF;">%       x = 0:10;  y = sin(x);</span><br/>               <span style="color: #A0A0A0">  30</span> <span style="color: #228B22; background: #FFFFFF;">%       xx = 0:.25:10;</span><br/>               <span style="color: #A0A0A0">  31</span> <span style="color: #228B22; background: #FFFFFF;">%       yy = spline(x,y,xx);</span><br/>               <span style="color: #A0A0A0">  32</span> <span style="color: #228B22; background: #FFFFFF;">%       plot(x,y,'o',xx,yy)</span><br/>               <span style="color: #A0A0A0">  33</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  34</span> <span style="color: #228B22; background: #FFFFFF;">%   Example:</span><br/>               <span style="color: #A0A0A0">  35</span> <span style="color: #228B22; background: #FFFFFF;">%   This illustrates the use of clamped or complete spline interpolation where</span><br/>               <span style="color: #A0A0A0">  36</span> <span style="color: #228B22; background: #FFFFFF;">%   end slopes are prescribed. In this example, zero slopes at the ends of an </span><br/>               <span style="color: #A0A0A0">  37</span> <span style="color: #228B22; background: #FFFFFF;">%   interpolant to the values of a certain distribution are enforced:</span><br/>               <span style="color: #A0A0A0">  38</span> <span style="color: #228B22; background: #FFFFFF;">%      x = -4:4; y = [0 .15 1.12 2.36 2.36 1.46 .49 .06 0];</span><br/>               <span style="color: #A0A0A0">  39</span> <span style="color: #228B22; background: #FFFFFF;">%      cs = spline(x,[0 y 0]);</span><br/>               <span style="color: #A0A0A0">  40</span> <span style="color: #228B22; background: #FFFFFF;">%      xx = linspace(-4,4,101);</span><br/>               <span style="color: #A0A0A0">  41</span> <span style="color: #228B22; background: #FFFFFF;">%      plot(x,y,'o',xx,ppval(cs,xx),'-');</span><br/>               <span style="color: #A0A0A0">  42</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  43</span> <span style="color: #228B22; background: #FFFFFF;">%   Class support for inputs x, y, xx:</span><br/>               <span style="color: #A0A0A0">  44</span> <span style="color: #228B22; background: #FFFFFF;">%      float: double, single</span><br/>               <span style="color: #A0A0A0">  45</span> <span style="color: #228B22; background: #FFFFFF;">%</span><br/>               <span style="color: #A0A0A0">  46</span> <span style="color: #228B22; background: #FFFFFF;">%   See also INTERP1, PCHIP, PPVAL, UNMKPP, MKPP, SPLINES (The Spline Toolbox).</span><br/>               <span style="color: #A0A0A0">  47</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  48</span> <span style="color: #228B22; background: #FFFFFF;">%   Carl de Boor 7-2-86</span><br/>               <span style="color: #A0A0A0">  49</span> <span style="color: #228B22; background: #FFFFFF;">%   Copyright 1984-2004 The MathWorks, Inc.</span><br/>               <span style="color: #A0A0A0">  50</span> <span style="color: #228B22; background: #FFFFFF;">%   $Revision: 5.18.4.4 $  $Date: 2004/12/06 16:35:53 $</span><br/>               <span style="color: #A0A0A0">  51</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><a name="Line52"></a><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   2884 </span><span style="color: #000000; font-weight: bold">  52</span> <span style="color: #000000; background: #FFFFFF;">output=[]; </span><br/>               <span style="color: #A0A0A0">  53</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  54</span> <span style="color: #228B22; background: #FFFFFF;">% Check that data are acceptable and, if not, try to adjust them appropriately</span><br/><span style="color: #FF0000">  0.25 </span><span style="color: #0000FF">   2884 </span><span style="color: #000000; font-weight: bold">  55</span> <span style="color: #000000; background: #FFB8B8;">[x,y,sizey,endslopes] = <a href="file52.html">chckxy</a>(x,y); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   2884 </span><span style="color: #000000; font-weight: bold">  56</span> <span style="color: #000000; background: #FFFFFF;">n = length(x); yd = prod(sizey); </span><br/>               <span style="color: #A0A0A0">  57</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  58</span> <span style="color: #228B22; background: #FFFFFF;">% Generate the cubic spline interpolant in ppform</span><br/>               <span style="color: #A0A0A0">  59</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">   2884 </span><span style="color: #000000; font-weight: bold">  60</span> <span style="color: #000000; background: #FFFFFF;">dd = ones(yd,1); dx = diff(x); divdif = diff(y,[],2)./dx(dd,:);  </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   2884 </span><span style="color: #000000; font-weight: bold">  61</span> <span style="color: #000000; background: #FFFFFF;">if n==2 </span><br/>               <span style="color: #A0A0A0">  62</span> <span style="color: #A0A0A0; background: #FFFFFF;">   if isempty(endslopes) % the interpolant is a straight line</span><br/>               <span style="color: #A0A0A0">  63</span> <span style="color: #A0A0A0; background: #FFFFFF;">      pp=mkpp(x,[divdif y(:,1)],sizey);</span><br/>               <span style="color: #A0A0A0">  64</span> <span style="color: #228B22; background: #FFFFFF;">   else         % the interpolant is the cubic Hermite polynomial</span><br/>               <span style="color: #A0A0A0">  65</span> <span style="color: #A0A0A0; background: #FFFFFF;">      pp = pwch(x,y,endslopes,dx,divdif); pp.dim = sizey;</span><br/>               <span style="color: #A0A0A0">  66</span> <span style="color: #A0A0A0; background: #FFFFFF;">   end</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   2884 </span><span style="color: #000000; font-weight: bold">  67</span> <span style="color: #000000; background: #FFFFFF;">elseif n==3&amp;&amp;isempty(endslopes) % the interpolant is a parabola </span><br/>               <span style="color: #A0A0A0">  68</span> <span style="color: #A0A0A0; background: #FFFFFF;">   y(:,2:3)=divdif;</span><br/><a name="Line69"></a>               <span style="color: #A0A0A0">  69</span> <span style="color: #A0A0A0; background: #FFFFFF;">   y(:,3)=diff(divdif')'/(x(3)-x(1));</span><br/>               <span style="color: #A0A0A0">  70</span> <span style="color: #A0A0A0; background: #FFFFFF;">   y(:,2)=y(:,2)-y(:,3)*dx(1); </span><br/>               <span style="color: #A0A0A0">  71</span> <span style="color: #A0A0A0; background: #FFFFFF;">   pp = mkpp(x([1,3]),y(:,[3 2 1]),sizey);</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   2884 </span><span style="color: #000000; font-weight: bold">  72</span> <span style="color: #228B22; background: #FFFFFF;">else % set up the sparse, tridiagonal, linear system b = ?*c for the slopes </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   2884 </span><span style="color: #000000; font-weight: bold">  73</span> <span style="color: #000000; background: #FFFFFF;">   b=zeros(yd,n); </span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">   2884 </span><span style="color: #000000; font-weight: bold">  74</span> <span style="color: #000000; background: #FFFFFF;">   b(:,2:n-1)=3*(dx(dd,2:n-1).*divdif(:,1:n-2)+dx(dd,1:n-2).*divdif(:,2:n-1)); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   2884 </span><span style="color: #000000; font-weight: bold">  75</span> <span style="color: #000000; background: #FFFFFF;">   if isempty(endslopes) </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   2884 </span><span style="color: #000000; font-weight: bold">  76</span> <span style="color: #000000; background: #FFFFFF;">      x31=x(3)-x(1);xn=x(n)-x(n-2); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   2884 </span><span style="color: #000000; font-weight: bold">  77</span> <span style="color: #000000; background: #FFFFFF;">      b(:,1)=((dx(1)+2*x31)*dx(2)*divdif(:,1)+dx(1)^2*divdif(:,2))/x31; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   2884 </span><span style="color: #000000; font-weight: bold">  78</span> <span style="color: #000000; background: #FFFFFF;">      b(:,n)=... </span><br/>               <span style="color: #A0A0A0">  79</span> <span style="color: #000000; background: #FFFFFF;">      (dx(n-1)^2*divdif(:,n-2)+(2*xn+dx(n-1))*dx(n-2)*divdif(:,n-1))/xn;</span><br/>               <span style="color: #A0A0A0">  80</span> <span style="color: #228B22; background: #FFFFFF;">   else</span><br/>               <span style="color: #A0A0A0">  81</span> <span style="color: #A0A0A0; background: #FFFFFF;">      x31 = 0; xn = 0; b(:,[1 n]) = dx(dd,[2 n-2]).*endslopes;</span><br/>               <span style="color: #A0A0A0">  82</span> <span style="color: #A0A0A0; background: #FFFFFF;">   end</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   2884 </span><span style="color: #000000; font-weight: bold">  83</span> <span style="color: #000000; background: #FFFFFF;">   dxt = dx(:); </span><br/><span style="color: #FF0000">  0.48 </span><span style="color: #0000FF">   2884 </span><span style="color: #000000; font-weight: bold">  84</span> <a name="Line84"></a><span style="color: #000000; background: #FF8080;">   c = <a href="file53.html">spdiags</a>([ [x31;dxt(1:n-2);0] ... </span><br/><a name="Line85"></a>               <span style="color: #A0A0A0">  85</span> <span style="color: #000000; background: #FF8080;">        [dxt(2);2*[dxt(2:n-1)+dxt(1:n-2)];dxt(n-2)] ...</span><br/>               <span style="color: #A0A0A0">  86</span> <span style="color: #000000; background: #FF8080;">        [0;dxt(2:n-1);xn] ],[-1 0 1],n,n);</span><br/>               <span style="color: #A0A0A0">  87</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  88</span> <span style="color: #228B22; background: #FFFFFF;">   % sparse linear equation solution for the slopes</span><br/><span style="color: #FF0000">  0.22 </span><span style="color: #0000FF">   2884 </span><span style="color: #000000; font-weight: bold">  89</span> <span style="color: #000000; background: #FFC6C6;">   mmdflag = <a href="file54.html">spparms</a>('autommd'); </span><br/><span style="color: #FF0000">  0.44 </span><span style="color: #0000FF">   2884 </span><span style="color: #000000; font-weight: bold">  90</span> <a name="Line90"></a><span style="color: #000000; background: #FF8080;">   <a href="file54.html">spparms</a>('autommd',0); </span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">   2884 </span><span style="color: #000000; font-weight: bold">  91</span> <span style="color: #000000; background: #FFFFFF;">   s=b/c; </span><br/><span style="color: #FF0000">  0.39 </span><span style="color: #0000FF">   2884 </span><span style="color: #000000; font-weight: bold">  92</span> <a name="Line92"></a><span style="color: #000000; background: #FF8E8E;">   <a href="file54.html">spparms</a>('autommd',mmdflag); </span><br/>               <span style="color: #A0A0A0">  93</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  94</span> <span style="color: #228B22; background: #FFFFFF;">   % construct piecewise cubic Hermite interpolant</span><br/>               <span style="color: #A0A0A0">  95</span> <span style="color: #228B22; background: #FFFFFF;">   % to values and computed slopes</span><br/><span style="color: #FF0000">  0.41 </span><span style="color: #0000FF">   2884 </span><span style="color: #000000; font-weight: bold">  96</span> <a name="Line96"></a><span style="color: #000000; background: #FF8E8E;">   pp = <a href="file37.html">pwch</a>(x,y,s,dx,divdif); pp.dim = sizey; </span><br/>               <span style="color: #A0A0A0">  97</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">   2884 </span><span style="color: #000000; font-weight: bold">  98</span> <span style="color: #000000; background: #FFFFFF;">end </span><br/>               <span style="color: #A0A0A0">  99</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.35 </span><span style="color: #0000FF">   2884 </span><span style="color: #000000; font-weight: bold"> 100</span> <a name="Line100"></a><span style="color: #000000; background: #FF9C9C;">if nargin==2, output = pp; else output = <a href="file56.html">ppval</a>(pp,xx); end </span><br/></pre></body></html>